pipeline {

  agent {
    kubernetes {
      label 'release-stable'
    }
  }

  options {
    buildDiscarder logRotator(
      artifactDaysToKeepStr: '14',
      artifactNumToKeepStr: '5',
      daysToKeepStr: '30',
      numToKeepStr: '10'
    )
    disableConcurrentBuilds()
  }

  stages {
    stage("Release"){
      steps {
        build job: 'core/release/master', parameters: [
          string(name: "RELEASE_PROFILE", value: "stable")
        ]
      }
    }
    stage("Package"){
      steps {
        build job: 'core/package/master', parameters: [
          string(name: "RELEASE_PROFILE", value: "stable")
        ]
      }
    }
  }
}
